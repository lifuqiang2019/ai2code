# 🚀 AI 识别功能快速测试指南

## 前置准备

### 1. 配置 API Key

编辑 `packages/ai-background/.env` 文件：

```env
GLM_API_KEY=你的智谱API密钥
```

如果没有 API Key，请访问：https://open.bigmodel.cn/

### 2. 启动服务

**终端 1 - 启动后端：**
```bash
cd packages/ai-background
npm install  # 首次需要
npm run start:dev
```

等待看到：`Nest application successfully started`

**终端 2 - 启动前端：**
```bash
cd packages/app
npm install  # 首次需要
npm run dev
```

访问：http://localhost:5173

---

## 快速测试步骤

### 方法 1：使用测试图片（推荐）

1. 打开画图软件（Windows 画图 / Mac 预览）
2. 绘制几个简单的几何形状：
   - 一个红色圆形
   - 一个蓝色矩形
   - 一个绿色三角形
3. 截图保存（或直接 Ctrl+C 复制）
4. 在应用中点击 **"AI 识别"** 按钮
5. **Ctrl+V** 粘贴图片
6. 点击 **"开始识别"**
7. 查看识别结果
8. 点击 **"导入到画布"**

### 方法 2：使用在线图片

1. 点击 **"AI 识别"** 按钮
2. 切换到 **"URL 导入"** 标签
3. 输入测试 URL（例如包含几何形状的图片链接）
4. 点击 **"加载"**
5. 点击 **"开始识别"**
6. 点击 **"导入到画布"**

---

## 验证功能

✅ **基础功能测试**
- [ ] 能成功上传图片
- [ ] 能识别基本形状（圆形、矩形、三角形）
- [ ] 能识别颜色
- [ ] 能识别边框粗细
- [ ] 能导入到画布

✅ **高级功能测试**
- [ ] 支持拖拽上传
- [ ] 支持 Ctrl+V 粘贴
- [ ] 支持 URL 导入
- [ ] 能识别多个形状
- [ ] 能识别层级关系
- [ ] 可以删除不需要的识别结果

✅ **错误处理测试**
- [ ] 上传无关图片能正确提示
- [ ] 文件过大有提示
- [ ] 格式不支持有提示

---

## 预期结果

### 成功案例

**输入：** 包含红色圆形的图片

**输出：**
```
✓ 圆形 (红色) - 第 1 层 [删除]
```

**画布：** 自动生成一个红色圆形，位置和大小与原图相似

### 失败案例

**输入：** 风景照片

**输出：**
```
图片中未识别到项目相关的几何形状
```

---

## 常见问题排查

### 问题：点击"开始识别"后长时间无响应

**检查：**
```bash
# 查看后端日志
cd packages/ai-background
npm run start:dev

# 查看是否有错误信息
```

### 问题：提示"未配置 GLM API Key"

**解决：**
1. 检查 `.env` 文件是否存在
2. 检查 `GLM_API_KEY` 是否正确
3. 重启后端服务

### 问题：识别结果为空

**可能原因：**
- 图片中没有几何形状
- 图片质量太差
- API 额度不足

---

## 演示视频流程

1. **启动应用** - 显示主界面
2. **点击 AI 识别** - 打开对话框
3. **粘贴图片** - Ctrl+V 快捷键
4. **开始识别** - 显示加载动画
5. **查看结果** - 识别到的形状列表
6. **导入画布** - 自动生成形状
7. **编辑形状** - 可以继续编辑

---

## 测试数据建议

### 简单测试（推荐新手）
- 1-3 个基本形状
- 纯色背景
- 清晰边界

### 中等难度
- 3-5 个形状
- 部分重叠
- 不同颜色

### 高难度
- 5-10 个形状
- 多层重叠
- 带边框和填充

---

## 性能指标

| 场景 | 识别时间 | 准确率 |
|-----|---------|--------|
| 1-3个简单形状 | 2-3秒 | 90%+ |
| 3-5个中等形状 | 3-5秒 | 80%+ |
| 5+个复杂形状 | 5-8秒 | 70%+ |

---

## 下一步

测试成功后，你可以：
1. ✅ 尝试更复杂的形状组合
2. ✅ 测试不同的上传方式
3. ✅ 查看完整文档：[AI_RECOGNITION_GUIDE.md](./AI_RECOGNITION_GUIDE.md)
4. ✅ 自定义 API 配置
5. ✅ 优化识别效果

---

**祝测试顺利！** 🎉

有问题查看控制台日志或阅读详细文档。

